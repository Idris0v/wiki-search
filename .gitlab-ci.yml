stages:
  - prep
  - build
  - test


prepare the car:
  stage: prep
  script:
    - mkdir build
    - cd build
    - touch car.txt
  artifacts:
    paths:
      - build/

build car:
  stage: build
  script:
    - cd build
    - echo "chassis" >> car.txt
    - echo "wheels" >> car.txt
    - echo "roof" >> car.txt
    - mkdir meta
    - cd meta
    - echo $GITLAB_USER_NAME > author.txt
  artifacts:
    paths:
      - build/

author:
  script:
    - mkdir meta
    - cd meta
    - echo $GITLAB_USER_NAME > author.txt
    - cat author.txt
  artifacts:
    paths:
      - build/

test car:
  stage: test
  script:
    - test -f build/car.txt
    - cd build
    - cat car.txt
    - grep "chassis" car.txt
    - grep "wheels" car.txt
    - grep "wheels" car.txt

